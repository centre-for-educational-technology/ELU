{"version":3,"sources":["app.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["jQuery(document).ready(function($) {\n\n\n  $.ajaxSetup({\n    headers: {\n      'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n    }\n  });\n\n  // Date picker\n  $('#project_start').datetimepicker({\n    format: 'L'\n  });\n\n  $('#project_end').datetimepicker({\n    format: 'L'\n  });\n\n  $('#join_deadline').datetimepicker({\n    format: 'L'\n  });\n\n  $('#project_start').datetimepicker();\n  $('#project_end').datetimepicker({\n    useCurrent: false //Important! See issue #1075\n  });\n  $(\"#project_start\").on(\"dp.change\", function (e) {\n    $('#project_end').data(\"DateTimePicker\").minDate(e.date);\n  });\n  $(\"#project_end\").on(\"dp.change\", function (e) {\n    $('#project_start').data(\"DateTimePicker\").maxDate(e.date);\n  });\n\n\n\n  // Tags input\n  $('input #tags').on('change', function(event) {\n    var $element = $(event.target),\n      $container = $element.closest('.example');\n\n    var val = $element.val();\n    if (val === null)\n      val = \"null\";\n    $('code', $('pre.val', $container)).html( ($.isArray(val) ? JSON.stringify(val) : \"\\\"\" + val.replace('\"', '\\\\\"') + \"\\\"\") );\n    $('code', $('pre.items', $container)).html(JSON.stringify($element.tagsinput('items')));\n  }).trigger('change');\n\n\n  // Sweet alert\n  $(\"button#delete\").on(\"click\", function(e){\n\n    swal({\n        title: window.Laravel.are_you_sure_notification,\n        text: window.Laravel.cannot_restore_notification,\n        type: \"warning\",\n        showCancelButton: true,\n        confirmButtonColor: \"#DD6B55\",\n        confirmButtonText: window.Laravel.yes_delete,\n        cancelButtonText: window.Laravel.no,\n        closeOnConfirm: false\n      },\n      function(){\n        $(e.target).prev('.delete-project').submit();\n\n      });\n\n  });\n\n\n  $(\"button#delete-user-button\").on(\"click\", function(e){\n\n    swal({\n        title: window.Laravel.are_you_sure_notification,\n        type: \"warning\",\n        showCancelButton: true,\n        confirmButtonColor: \"#DD6B55\",\n        confirmButtonText: window.Laravel.yes_delete,\n        cancelButtonText: window.Laravel.no,\n        closeOnConfirm: false\n      },\n      function(){\n        $(e.target).prev('.delete-user').submit();\n\n      });\n\n  });\n\n\n  $(\"a#groups-finish-button\").on(\"click\", function(e){\n    if(!$(\"a#groups-finish-button\").hasClass('not-empty')){\n      e.preventDefault();\n\n      swal({\n        title: window.Laravel.finish_project_notification,\n        type: \"info\",\n        confirmButtonText: window.Laravel.yes,\n        closeOnConfirm: false\n      });\n    }\n\n\n  });\n\n  // Select2\n  $(\".js-example-basic-multiple\").select2();\n\n\n\n  // Select2 Ajax - attaching users to project team manually\n  $(\".js-users-data-ajax\").select2({\n    placeholder: \"Nimi või e-posti aadress\",\n    language: { inputTooShort: function () { return 'Kolm või rohkem tähte'; } },\n    allowClear: true,\n    ajax: {\n      url: window.Laravel.search_user_api_url,\n      dataType: 'json',\n      delay: 250,\n      method: 'POST',\n      data: function (params) {\n        return {\n          q: params.term, // search term\n          project_id: $('.js-users-data-ajax').attr(\"project-id\"),\n          page: params.page\n        };\n      },\n      processResults: function (data) {\n        return {\n          results: $.map(data, function (item) {\n            return {\n              text: (item.full_name ? item.full_name : item.name) + ' ('+item.email+')',\n              id: item.id\n            }\n          })\n        };\n      },\n      cache: false\n    },\n    escapeMarkup: function (markup) { return markup; }, // let our custom formatter work\n    minimumInputLength: 3\n  });\n\n  //Smooth scroll for front page\n  $('body.frontpage a[href*=\"#\"]:not([href=\"#\"])').click(function() {\n    if (location.pathname.replace(/^\\//,'') == this.pathname.replace(/^\\//,'') && location.hostname == this.hostname) {\n      var target = $(this.hash);\n      target = target.length ? target : $('[name=' + this.hash.slice(1) +']');\n      if (target.length) {\n        $('html, body').animate({\n          scrollTop: target.offset().top\n        }, 1000);\n        return false;\n      }\n    }\n  });\n\n\n\n  //Go from front page to certain tab in FAQ page\n  var hash = window.location.hash;\n  if(hash.startsWith('#item')){\n    hash && $('ul.nav a[href=\"' + hash + '\"]').tab('show');\n  }\n\n  //Search form\n  $('.search-panel .navbar-nav').find('a').click(function(e) {\n    e.preventDefault();\n    var param = $(this).attr(\"href\").replace(\"#\",\"\");\n    var concept = $(this).text();\n    $('.search-panel span#search_concept').text(concept);\n    $('.form-group #search_param').val(param);\n  });\n\n  var selector = '.search-panel .navbar-nav li';\n\n  $(selector).on('click', function(){\n    $(selector).removeClass('active');\n    $(this).addClass('active');\n  });\n\n\n\n  //Panel used in search view to show a list of member emails\n  $('.panel-heading span.clickable').parents('.panel').find('.panel-body').slideUp();\n\n  $('.panel-heading span.clickable').on(\"click\", function(e){\n    var $this = $(this);\n    if(!$this.hasClass('panel-collapsed')) {\n      $this.parents('.panel').find('.panel-body').slideUp();\n      $this.addClass('panel-collapsed');\n      $this.find('i').removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');\n    } else {\n      $this.parents('.panel').find('.panel-body').slideDown();\n      $this.removeClass('panel-collapsed');\n      $this.find('i').removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');\n    }\n  });\n\n\n  //Facebook sharing button handler, Facebook SDK for JavaScript\n  function postToFeed(title, desc, url, image){\n    var obj = {method: 'feed',link: url, picture:image, name: title,description: desc};\n    function callback(response){}\n    FB.ui(obj, callback);\n  }\n\n  $('.btnShare').click(function(){\n    elem = $(this);\n    postToFeed(elem.data('title'), elem.data('desc'), elem.prop('href'), elem.data('image'));\n\n    return false;\n  });\n\n\n  //TinyMC\n  tinyMCE.baseURL = window.Laravel.base_path+\"/js/tinymce\";\n\n  tinymce.init({\n    mode : \"textareas\",\n    theme : \"modern\",\n    language: window.Laravel.language,\n    plugins: \"link\",\n    menubar: false,\n    toolbar: \"link\",\n    removeformat: [\n      {selector: 'b,strong,em,i,font,u,strike', remove : 'all', split : true, expand : false, block_expand: true, deep : true},\n      {selector: 'span', attributes : ['style', 'class'], remove : 'empty', split : true, expand : false, deep : true},\n      {selector: '*', attributes : ['style', 'class'], split : false, expand : false, deep : true}\n    ],\n    selection_toolbar: 'bold italic | quicklink h2 h3 blockquote',\n    editor_selector : \"mceSimpleLink\"\n  });\n\n\n  tinyMCE.init({\n    mode : \"textareas\",\n    language: window.Laravel.language,\n    plugins: [\"link\", \"lists\"],\n    height : \"350\",\n    removeformat: [\n      {selector: 'b,strong,em,i,font,u,strike', remove : 'all', split : true, expand : false, block_expand: true, deep : true},\n      {selector: 'span', attributes : ['style', 'class'], remove : 'empty', split : true, expand : false, deep : true},\n      {selector: '*', attributes : ['style', 'class'], split : false, expand : false, deep : true}\n    ],\n    toolbar: \"redo undo bold italic numlist bullist link\",\n    menubar: false,\n    editor_selector : \"mceSimple\"\n  });\n\n\n  //Front page logo translation\n  if(window.Laravel.language == 'en'){\n    $('.block01.block01b > .pad').css(\"background\", 'url(css/bg05_en.png) no-repeat 50% 50%');\n  }else{\n    $('.block01.block01b > .pad').css(\"background\", 'url(css/bg05.png) no-repeat 50% 50%');\n  }\n\n\n  //Select project share url on click on input\n  $(\"input[name='share_url']\").on(\"click\", function () {\n    $(this).select();\n  });\n\n\n  if($(\"#project_all_members\").length) {\n\n    //Project id used by ProjectModerator middleware\n    var url = window.location.pathname;\n    var segments = url.split( '/' );\n    var project_id =  segments[segments.length-2];\n\n\n    //Drag and drop project group members functionality\n    Sortable.create(project_all_members, {\n      group: { name: \"project-all-members\", pull: true, put:true },\n      animation: 150,\n      handle: '.drag-handle'\n    });\n\n    var el = $('.project-group');\n    $(el).each(function (i,e) {\n      var sortable = Sortable.create(e, {\n        group: {\n          name: el.attr('group-id'),\n          pull: true,\n          put: function () {\n            return true;\n          }\n        },\n        animation: 150,\n        handle: '.drag-handle',\n        onAdd: function (evt) {\n\n          var itemEl = evt.item;  // dragged HTMLElement\n          var from = evt.from;\n\n\n          $.ajax({\n            url: window.Laravel.add_user_to_group_api_url,\n            dataType: 'json',\n            delay: 250,\n            method: 'POST',\n            cache: false,\n            data: {\n\n              id: project_id,\n              to: $(itemEl).parent().attr('group-id'),\n              from: $(from).attr('group-id'),\n              user: $(itemEl).attr('user-id')\n\n            }\n          }).done(function( msg ) {\n            console.log(msg);\n            if($('a#groups-finish-button').length){\n              $('a#groups-finish-button').addClass('not-empty');\n            }\n\n\n          });\n\n        }\n\n      });\n    })\n  }\n\n\n  //Copy user main TLU email into contact email fields, used on profile page\n  $(\"#filler\").click(fillValues);\n\n\n  function fillValues() {\n    var value = $(\"#tlu_email\").val();\n    var fields= $(\".contact-email\");\n    fields.each(function (i) {\n      $(this).val(value);\n    });\n  }\n\n\n\n  //Add custom institution field in user registration form\n  $('#institution').on('change',function(){\n    if( $(this).val() === window.Laravel.other_institution){\n      $(\"#other-institution\").show()\n    }\n    else{\n      $(\"#other-institution\").hide()\n    }\n  });\n\n\n\n\n  // Add new group links input field\n  var add_links_field_buttons = $(\".add_links_field_button\");\n\n  add_links_field_buttons.each(function (i, obj) {\n    var group_id = $(obj).attr(\"group-id\");\n    $(obj).click(function(e){\n      e.preventDefault();\n      var $div = $(this).next( \".group-materials\").children().last();\n\n      var num = $div.prop(\"id\");\n\n      num = parseInt(num.split(\"_\").pop());\n\n\n      console.log(num);\n      var clone = $($div).clone();\n      clone.prop('id', 'group_materials_'+group_id+'_'+(num+1));\n      clone.find(\"input\").val(\"\");\n      clone.insertAfter($div);\n\n      var tagsinput = clone.find('.tags');\n      clone.find('.bootstrap-tagsinput').remove();\n\n      $(tagsinput).attr('name', 'group_material_tags['+group_id+'][]');\n      $(tagsinput).addClass('form-control tags');\n      tagsinput.tagsinput();\n      tagsinput.tagsinput('removeAll');\n\n\n\n\n\n    });\n\n  });\n\n\n\n\n  // Remove group links input field\n  var remove_links_field_button = $(\".remove_links_field_button\");\n\n  remove_links_field_button.each(function (i, obj) {\n    var group_id = $(obj).attr(\"group-id\");\n    $(obj).click(function(e){\n      e.preventDefault();\n      var $div = $(this).next( \"div\");\n\n      var num = $div.prop(\"id\");\n\n      num = parseInt(num.split(\"_\").pop());\n\n      if(num>0){\n        $div.remove();\n        this.remove();\n      }\n\n\n\n\n\n\n    });\n  });\n\n\n\n  $('[data-toggle=\"popover\"]').popover()\n\n\n\n\n});\n\nDropzone.autoDiscover = false;\nDropzone.prototype.defaultOptions.dictRemoveFile = window.Laravel.remove_file_button;\n\nvar dropzones = $(\".dropzone\");\ndropzones.each(function (i) {\n  //Group images upload\n  var group_id = parseInt( $(this).prop(\"id\").match(/\\d+/g), 10 );\n\n  var project_id = $('#groupImagesUpload'+group_id).attr(\"project-id\");\n  var dropzone_name = '#groupImagesUpload'+group_id;\n\n   var myDropzone = new Dropzone(dropzone_name, {\n    url: window.Laravel.base_path+\"/project/\"+project_id+\"/finish/uploadFiles\",\n    params: {\n      id: project_id,\n      _token: window.Laravel.csfr_token,\n      group_id: group_id\n    },\n    parallelUploads: 20,\n    paramName: \"file\",\n    maxFilesize: 2, // MB\n\n\n    addRemoveLinks: true,\n\n    init:function() {\n\n\n      // Add server images\n      var myDropzone = this;\n\n\n      $.get(window.Laravel.base_path+\"/project/\"+project_id+\"/api/group-images?groupid=\"+group_id, function(data) {\n\n\n        $.each(data.images, function (key, value) {\n\n          var file = {name: value.name, size: value.size};\n          myDropzone.options.addedfile.call(myDropzone, file);\n          myDropzone.createThumbnailFromUrl(file, window.Laravel.base_path+\"/storage/projects_groups_images/\"+group_id+\"/\"+value.name);\n          myDropzone.emit(\"complete\", file);\n          var btndelete = file.previewElement.querySelector(\"[data-dz-remove]\");\n          btndelete.setAttribute(\"id\", 'delete-media-name-'+value.name);\n\n        });\n      });\n\n      this.on(\"removedfile\", function(file) {\n\n        var btndelete = file.previewElement.querySelector(\"[data-dz-remove]\");\n        if(btndelete.hasAttribute(\"id\")) {\n          var filename = btndelete.getAttribute(\"id\").split('-').pop();\n        }\n\n        $.ajax({\n          url: window.Laravel.base_path+\"/project/\"+project_id+\"/finish/deleteFile\",\n          dataType: 'json',\n          delay: 250,\n          method: 'POST',\n          cache: false,\n          data: {\n\n            id: project_id,\n            name: filename,\n            group_id: group_id\n\n          }\n        }).done(function( msg ) {\n          console.log(msg);\n\n        });\n\n      } );\n    },\n    success: function(file, serverResponse) {\n      var fileuploded = file.previewElement.querySelector(\"[data-dz-name]\");\n      fileuploded.innerHTML = serverResponse.newfilename;\n      var btndelete = file.previewElement.querySelector(\"[data-dz-remove]\");\n      btndelete.setAttribute(\"id\", 'delete-media-name-'+serverResponse.newfilename);\n    }\n  });\n});\n\n\n\n\n\n\n\n\n/*\n  Sending DELETE request without a form\n  Example:\n  <a href=\"posts/2\" data-method=\"delete\" data-token=\"{{csrf_token()}}\">\n */\n\n(function() {\n\n  var laravel = {\n    initialize: function() {\n      this.methodLinks = $('a[data-method]');\n      this.token = $('a[data-token]');\n      this.registerEvents();\n    },\n\n    registerEvents: function() {\n      this.methodLinks.on('click', this.handleMethod);\n    },\n\n    handleMethod: function(e) {\n      var link = $(this);\n      var httpMethod = link.data('method').toUpperCase();\n      var form;\n\n      // If the data-method attribute is not PUT or DELETE,\n      // then we don't know what to do. Just ignore.\n      if ( $.inArray(httpMethod, ['PUT', 'DELETE']) === - 1 ) {\n        return;\n      }\n\n      // Allow user to optionally provide data-confirm=\"Are you sure?\"\n      if ( link.data('confirm') ) {\n        if ( ! laravel.verifyConfirm(link) ) {\n          return false;\n        }\n      }\n\n      form = laravel.createForm(link);\n      form.submit();\n\n      e.preventDefault();\n    },\n\n    verifyConfirm: function(link) {\n      return confirm(link.data('confirm'));\n    },\n\n    createForm: function(link) {\n      var form =\n        $('<form>', {\n          'method': 'POST',\n          'action': link.attr('href')\n        });\n\n      var token =\n        $('<input>', {\n          'type': 'hidden',\n          'name': '_token',\n          'value': link.data('token')\n        });\n\n      var hiddenInput =\n        $('<input>', {\n          'name': '_method',\n          'type': 'hidden',\n          'value': link.data('method')\n        });\n\n      return form.append(token, hiddenInput)\n        .appendTo('body');\n    }\n  };\n\n  laravel.initialize();\n\n})();\n"],"sourceRoot":"/source/"}